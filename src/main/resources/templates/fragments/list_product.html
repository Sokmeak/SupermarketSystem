<div th:fragment="content">
  <!-- Search and Filter Section -->
  <div class="row mb-3">
    <div class="col-md-12">
      <form th:action="@{/}" method="get" class="row g-3">
        <div class="col-md-4">
          <input
            type="text"
            class="form-control"
            name="keyword"
            th:value="${searchKeyword}"
            placeholder="Search by name or code..."
          />
        </div>
        <div class="col-md-4">
          <select class="form-select" name="categoryId">
            <option value="">All Categories</option>
            <option
              th:each="cat : ${categories}"
              th:value="${cat.id}"
              th:text="${cat.name}"
              th:selected="${cat.id == selectedCategory}"
            ></option>
          </select>
        </div>
        <div class="col-md-2">
          <button type="submit" class="btn btn-primary w-100">
            <i class="fa-solid fa-search"></i> Search
          </button>
        </div>
        <div class="col-md-2">
          <a th:href="@{/}" class="btn btn-secondary w-100">
            <i class="fa-solid fa-refresh"></i> Reset
          </a>
        </div>
      </form>
    </div>
  </div>

  <!-- Action Buttons -->
  <div class="mb-3">
    <a th:href="@{/create-form}" class="btn btn-success">
      <i class="fa-solid fa-plus"></i> Create Product
    </a>
    <a th:href="@{/categories}" class="btn btn-info">
      <i class="fa-solid fa-list"></i> Manage Categories
    </a>
  </div>

  <!-- Products Table -->
  <table class="table table-hover">
    <thead>
      <tr>
        <th scope="col">Code</th>
        <th scope="col">Name</th>
        <th scope="col">Category</th>
        <th scope="col">Price</th>
        <th scope="col">Figure</th>
        <th scope="col">Action</th>
      </tr>
    </thead>
    <tbody>
      <tr th:each="product: ${products}">
        <td th:text="${product.getCode()}"></td>
        <td th:text="${product.getName()}"></td>
        <td
          th:text="${product.category != null ? product.category.name : 'N/A'}"
        ></td>
        <td th:text="${'$' + product.getPrice()}"></td>
        <th scope="row">
          <img
            th:src="${product.getImage()}"
            height="200"
            width="200"
            class="img-thumbnail"
            alt=""
          />
        </th>
        <td>
          <a
            th:href="@{/edit/{code}(code=${product.getCode()})}"
            class="btn btn-sm btn-warning"
          >
            <i class="fa-regular fa-pen-to-square"></i> Edit
          </a>
          <a
            th:href="@{/remove/{code}(code=${product.getCode()})}"
            class="btn btn-sm btn-danger"
            onclick="return confirm('Are you sure you want to delete this product?')"
          >
            <i class="fa-solid fa-trash"></i> Delete
          </a>
        </td>
      </tr>
      <tr th:if="${#lists.isEmpty(products)}">
        <td colspan="6" class="text-center">No products found</td>
      </tr>
    </tbody>
  </table>
</div>
